{% extends 'login/dashboard.html' %}
{% block content %}
<form action="/pim/update/{{ personal.id }}/" name="emplist" id="emplist" enctype="multipart/form-data" method="POST" novalidate>
  {% csrf_token %}
  <div class="card" style="margin-top: 10px;" id="perdetails">
    <div class="card-header">
      <h5 class="card-title" id="editjobtitleLabel">Edit Personal Details</h5>
    </div>
    <div class="card-body">
      <div class="row">
        <div class="col-md-4">
          <label for="employee_id">Employee ID<font color=red>*</font></label>
          <input type="number" class="form-control" readonly name="employee_id" id="employee_id"
            value="{{ personal.employee_id }}">
        </div>
      </div>
      <div class="row">
        <div class="col-md-4">
          <label for="FirstName">First Name<font color=red>*</font></label>
          <input type="text" class="form-control" name="first_name" id="first_name" value="{{ personal.first_name }}"
            required>
          <div class="error" id="firstnameErr"></div>
        </div>
        <div class="col-md-4">
          <label for="MiddleName">Middle Name</label>
          <input type="text" class="form-control" name="middle_name" id="middle_name"
            value="{{ personal.middle_name }}">
          <div class="error" id="midnameErr"></div>
        </div>
        <div class="col-md-4">
          <label for="LastName">Last Name<font color=red>*</font></label>
          <input type="text" class="form-control" name="last_name" id="last_name" value="{{ personal.last_name }}"
            required>
          <div class="error" id="lastnameErr"></div>
        </div>
      </div>
      <div class="row">
        <div class="col-md-4">
          <label for="DateOfBirth">Date Of Birth<font color=red>*</font></label>
          <input type="date" class="form-control" name="date_of_birth" id="date_of_birth"
            value="{{ personal.date_of_birth }}" required>
          <div class="error" id="dobErr"></div>
        </div>
        <div class="col-md-4">
          <label for="Gender">Gender<font color=red>*</font></label>
          <select name="gender" class="form-control" id="gender">
            <option value="">Select</option>
            <option value="1" {% if personal.gender == 1 %}selected{% endif %}>Male</option>
            <option value="2" {% if personal.gender == 2 %}selected{% endif %}>Female</option>
          </select>
          <div class="error" id="genderErr"></div>
        </div>
        <div class="col-md-4">
          <label for="MaritalStatus">Marital Status<font color=red>*</font></label>
          <select name="marital_status" id ="marital_status" class="form-control">
            <option value="">Select</option>
            <option value="1" {% if personal.marital_status == 1 %}selected{% endif %}>Married</option>
            <option value="2" {% if personal.marital_status == 2 %}selected{% endif %}>Single</option>
            <option value="3" {% if personal.marital_status == 3 %}selected{% endif %}>Divorce</option>
            <option value="4" {% if personal.marital_status == 4 %}selected{% endif %}>Widow</option>
          </select>
          <div class="error" id="maritalstatusErr"></div>
        </div>
      </div>

      <div class="row">
        <div class="col-md-4">
          <label for="nationality">Nationality<font color=red>*</font></label>
          <select name="nationality" id="nationality" class="form-control">
            <option value="">Select</option>
            <option value="1" {% if personal.nationality == 1 %}selected{% endif %}>Indian</option>
            <option value="2" {% if personal.nationality == 2 %}selected{% endif %}>US</option>
          </select>
          <div class="error" id="nationalityErr"></div>
        </div>
        <div class="col-md-4">
          <label for="MiddleName">Aadhaar Number<font color=red>*</font></label>
          <input type="number" class="form-control" name="aadhar_card_no" id="aadhar_card_no"
            value="{{personal.aadhar_card_no}}" required>
          <div class="error" id="aadharErr"></div>
        </div>
        <div class="col-md-4">
          <label for="nickname">Nick Name<font color=red>*</font></label>
          <input type="text" class="form-control" name="nick_name" id="nick_name" value="{{personal.nick_name}}"
            required>
          <div class="error" id="nicknameErr"></div>
        </div>
      </div>
      <div class="row">
        <div class="col-md-12" style="float:right;">
          <button type="button" class="btn btn-primary pull-right" onclick="somefunction(1);">
            Next <i class="fa fa-angle-right"></i><i class="fa fa-angle-right"></i>
          </button>
          <a href="{% url 'pim:employeelist' %}">
              <button type="button" class="btn btn-primary">
                  <i class="fa fa-angle-left"></i><i class="fa fa-angle-left"></i>  Back
              </button>
            </a>
        </div>
      </div>
    </div>
  </div>
  <div class="card" style="margin-top: 10px;display:none;" id="empdetails">
    <div class="card-header">
      <h5 class="card-title" id="addjobtitleLabel">Edit Employment Details</h5>
    </div>
    <div class="card-body">
      <div class="row">
        <div class="col-md-4">
          <label for="joined_date">Joined Date:<font color=red>*</font></label>
          <input type="date" class="form-control" name="joined_date" id="joined_date" required
            value="{{personal.joined_date}}">
          <div class="error" id="joineddateErr"></div>
        </div>
        <div class="col-md-4">
          <label for="date_of_permanency">Date Of Permanency:<font color=red>*</font></label>
          <input type="date" class="form-control" name="date_of_permanency" id="date_of_permanency"
            value="{{personal.date_of_permanency}}" required>
          <div class="error" id="dopErr"></div>
        </div>
        <div class="col-md-4">
          <label for="JobTitle">Job Title<font color=red>*</font></label>
          <select name="job_title_id" id = "job_title" class="form-control">
            <option value="">Select</option>
            {% for job in jobtitles %}
            <option value="{{ job.id }}" {% if personal.job_title_id ==  job.id %} selected {% endif %}>
              {{ job.jobtitle }}
            </option>
            {% endfor %}
          </select>
          <div class="error" id="jobtitleErr"></div>
        </div>
      </div>
      <div class="row">
        <div class="col-md-4">
          <label for="JobCategory">Job Category<font color=red>*</font></label>
          <select name="job_category_id" id= "job_category" class="form-control">
            <option value="">Select</option>
            {% for job in jobcategory %}
            <option value="{{ job.id }}" {% if personal.job_category_id ==  job.id %} selected {% endif %}>
              {{ job.jobcategory }}</option>
            {% endfor %}
          </select>
          <div class="error" id="jobcategoryErr"></div>
        </div>
        <div class="col-md-4">
          <label for="Department">Department<font color=red>*</font></label>
          <select name="department_id" id ="department" class="form-control">
            <option value="">Select</option>
            {% for job in departments %}
            <option value="{{ job.id }}" {% if personal.department_id ==  job.id %} selected {% endif %}>
              {{ job.departmentname }}</option>
            {% endfor %}
          </select>
          <div class="error" id="departmentErr"></div>
        </div>
        <div class="col-md-4">
            <label for="worklocation">Location<font color=red>*</font></label>
            <select name="worklocation_id" id="worklocation" class="form-control">
              <option value="">Select</option>
               {% for job in locations %}
            <option value="{{ job.id }}" {% if personal.worklocation_id ==  job.id %} selected {% endif %}>{{ job.location }}</option>            
            {% endfor %}
            </select>
          <div class="error" id="worklocationErr"></div>
          </div>
      </div>
      <div class="row">
        <div class="col-md-4">
          <label for="EmploymentStatus">Employment Status<font color=red>*</font></label>
          <select name="employment_status_id" id="employment_status" class="form-control">
            <option value="">Select</option>
            {% for job in employmentstatus %}
            <option value="{{ job.id }}" {% if personal.employment_status_id ==  job.id %} selected {% endif %}>
              {{ job.employementstatus }}</option>
            {% endfor %}
          </select>
          <div class="error" id="employmentstatusErr"></div>
        </div>

        <div class="col-md-4">
          <label for="WorkShift">Work Shift<font color=red>*</font></label>
          <select name="work_shifts" id="work_shifts" class="form-control">
            <option value="">Select</option>
            <option value="1" {% if personal.work_shifts == 1 %}selected{% endif %}>General</option>
            <option value="2" {% if personal.work_shifts == 2 %}selected{% endif %}>Twilight</option>
          </select>
          <div class="error" id="workshiftErr"></div>
        </div>
      </div>
      <div class="row">
        <div class="col-md-12" style="float:right;">
          <button type="button" class="btn btn-primary pull-right" onclick="somefunction(2);">
            Save
          </button>
          <button type="button" class="btn btn-primary" onclick="somefunction(3);">
            <i class="fa fa-angle-left"></i><i class="fa fa-angle-left"></i> Prev
          </button>
        </div>
      </div>
    </div>
  </div>
</form>
<script>
function somefunction(val) {
  
    if (val == 1){
       flag = false;
      var firstname = document.getElementById('first_name').value;
      if(firstname == "") {
        printError("firstnameErr", "First Name Cannot Be Empty");
        return false;
      }else {
          var regex = /^[a-zA-Z\s]+$/; 
          if(regex.test(firstname) === false) {
          printError("firstnameErr", "Only Characters");
          return false;
          } else {
          printError("firstnameErr", "");
          flag = true;
          }
      }
      var midname = document.getElementById('middle_name').value;
      if(midname != "") {
          var regex = /^[a-zA-Z\s]+$/; 
          if(regex.test(midname) === false) {
          printError("midnameErr", "Only Characters");
          return false;
          } else {
          printError("midnameErr", "");
          midnameErr = false;
          }
      }
      var lastname = document.getElementById('last_name').value;
      if(lastname == "") {
        printError("lastnameErr", "Last Name Cannot Be Empty");
        return false;
      }else {
          var regex = /^[a-zA-Z\s]+$/; 
          if(regex.test(lastname) === false) {
          printError("lastnameErr", "Only Characters");
          return false;
          } else {
          printError("lastnameErr", "");
          lastnameErr = false;
          flag = true;
          }
      }
      var dob = document.getElementById('date_of_birth').value;
      if(dob == "") {
        printError("dobErr", "Please fill DOB");
        return false;
      } else {
          var today = new Date();
          var nowyear = today.getFullYear();
          var nowmonth = today.getMonth();
          var nowday = today.getDate();
          var b = document.getElementById('date_of_birth').value;
          var birth = new Date(b);
          var birthyear = birth.getFullYear();
          var birthmonth = birth.getMonth();
          var birthday = birth.getDate();
          var age = nowyear - birthyear;
          var age_month = nowmonth - birthmonth;
          var age_day = nowday - birthday;
          if ((age == 18 && age_month <= 0 && age_day <= 0) || age < 18) {
              printError("dobErr", "Age should be 18 or more than 18 years.Please enter a valid DOB");
              return false;
          }
          printError("dobErr", "");
          dobErr = false;
          flag = true;
      }
      var gen = document.getElementById('gender').value;
      if(gen == "") {
        printError("genderErr", "Please select Gender");
        return false;
      } else {
          printError("genderErr", "");
          genderErr = false;
          flag = true;
      }
      var maritalstatus = document.getElementById('marital_status').value;
      if(maritalstatus == "") {
        printError("maritalstatusErr", "Please select Marital Status");
        return false;
      } else {
          printError("maritalstatusErr", "");
          maritalstatusErr = false;
          flag = true;
      }
      var nation = document.getElementById('nationality').value;
      if(nation == "") {
        printError("nationalityErr", "Please select Nationality");
        return false;
      } else {
          printError("nationalityErr", "");
          nationalityErr = false;
          flag = true;
      }
      var aadhar = document.getElementById('aadhar_card_no').value;
      if(aadhar == "") {
      printError("aadharErr", "Aadhar number Cannot Be Empty");
      return false;
      }else{
      var aadhar = document.getElementById('aadhar_card_no').value;
      var adharcardTwelveDigit = /^\d{12}$/;
      var adharSixteenDigit = /^\d{16}$/;
      if (aadhar != '') {
            if (aadhar.match(adharcardTwelveDigit)) {
                printError("aadharErr", "");
            }
            else if (aadhar.match(adharSixteenDigit)) {
                printError("aadharErr", "");
            }
            else{
                printError("aadharErr", "Enter valid Aadhar number");
                return false;
            }
          }
        flag = true;
      }
      var nickname = document.getElementById('nick_name').value;
      if(nickname == "") {
        printError("nicknameErr", "Nick Name Cannot Be Empty");
        return false;
      }else {
          var regex = /^[a-zA-Z\s]+$/; 
          if(regex.test(nickname) === false) {
          printError("nicknameErr", "Only Characters");
          return false;
          } else {
          printError("nicknameErr", "");
          nicknameErr = false;
          flag = true;
          }
      }
      if (flag == true ) {
          document.getElementById('perdetails').style.display = 'none';
          document.getElementById('empdetails').style.display = 'block';
      }else{
          document.getElementById('empdetails').style.display = 'none';
          document.getElementById('perdetails').style.display = 'block';        
      }
    }else if(val==3){
          document.getElementById('empdetails').style.display = 'none';
          document.getElementById('perdetails').style.display = 'block'; 
    }else{
      flag = false;
      var jd = document.getElementById('joined_date').value;
      if(jd == "") {
        printError("joineddateErr", "Please fill joined date");
        return false;
      } else {
          printError("joineddateErr", "");
          joineddateErr = false;
          flag = true;
      }
      var dop = document.getElementById('date_of_permanency').value;
      if(dop == "") {
        printError("dopErr", "Please fill date of permanency");
        return false;
      } else {
          printError("dopErr", "");
          dopErr = false;
          flag = true;
      }
      var jobtitle = document.getElementById('job_title').value;
      if(jobtitle == "") {
        printError("jobtitleErr", "Please select job title");
        return false;
      } else {
          printError("jobtitleErr", "");
          jobtitleErr = false;
          flag = true;
      }
      var dept = document.getElementById('department').value;
      if(dept=="") {
        printError("departmentErr", "Please select department");
        return false;
      } else {
          printError("departmentErr", "");
          departmentErr = false;
          flag = true;
      }
      var wrkloc = document.getElementById('worklocation').value;
      if(wrkloc == "") {
        printError("worklocationErr", "Please select work location");
        return false;
      } else {
          printError("worklocationErr", "");
          worklocationErr = false;
          flag = true;
      }
      var empstatus = document.getElementById('employment_status').value;
      if(empstatus == "") {
        printError("employmentstatusErr", "Please select employment status");
        return false;
      } else {
          printError("employmentstatusErr", "");
          employmentstatusErr = false;
          flag = true;
      }
      var jobcat = document.getElementById('job_category').value;
      if(jobcat == "") {
        printError("jobcategoryErr", "Please select job category");
        return false;
      } else {
          printError("jobcategoryErr", "");
          jobcategoryErr = false;
          flag = true;
      }
      var wrkshift = document.getElementById('work_shifts').value;
      if(wrkshift == "") {
        printError("workshiftErr", "Please select work shift");
        return false;
      } else {
          printError("workshiftErr", "");
          workshiftErr = false;
          flag = true;
      }
      if (flag == false ){
          document.getElementById('empdetails').style.display = 'block';
          document.getElementById('perdetails').style.display = 'none';
      }else{
          document.getElementById('emplist').submit();
      }
      }
    }
function printError(elemId, hintMsg) {
    var Msg = hintMsg.fontcolor("red");
    document.getElementById(elemId).innerHTML = Msg;
}
</script>
<<<<<<< HEAD
=======

>>>>>>> 50e2e626a334dad26f4359f8e46ae7720f294fa3
{% endblock %}